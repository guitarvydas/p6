scm {
 Program = Sexpr+
 Sexpr = List | atom

  atom =
    | "#f" -- false
    | "#t" -- true
    | integer -- int
    | string -- string
    | symbol -- symbol

  integer = digit+
  string = "\"" (~"\"" any)* "\""
  symbol = id ("." id)*
  id = firstLetter followLetter*
  firstLetter = letter | (~separator any)
  followLetter = letter | digit | (~separator any)
  special  = ";" | "#" | "(" | ")" | "'" | "`" | "," | "." 
  separator = space | special | end

  List =
    | "(" ")" -- nil
    | "'" sexpr -- quoted
    | "`" sexpr -- backquoted
    | "," sexpr -- commaexpanded
    | "(" sexpr+ Dotted ")" -- dotted
    | "(" sexpr+ ")" -- list

  Dotted = "." #sexpr

  comment = ";" (~"\n" any)* "\n"
  space += comment
}
